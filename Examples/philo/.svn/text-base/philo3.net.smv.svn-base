MODULE main
VAR
  Idle0: 0..1;
  WaitLeft0: 0..1;
  HasLeft0: 0..1;
  WaitRight0: 0..1;
  HasRight0: 0..1;
  Fork0: 0..1;
  IsEating0: 0..1;
  Idle1: 0..1;
  WaitLeft1: 0..1;
  HasLeft1: 0..1;
  WaitRight1: 0..1;
  HasRight1: 0..1;
  Fork1: 0..1;
  IsEating1: 0..1;
  Idle2: 0..1;
  WaitLeft2: 0..1;
  HasLeft2: 0..1;
  WaitRight2: 0..1;
  HasRight2: 0..1;
  Fork2: 0..1;
  IsEating2: 0..1;

ASSIGN
  init(Idle0) := 1;
  init(WaitLeft0) := 0;
  init(HasLeft0) := 0;
  init(WaitRight0) := 0;
  init(HasRight0) := 0;
  init(Fork0) := 1;
  init(IsEating0) := 0;
  init(Idle1) := 1;
  init(WaitLeft1) := 0;
  init(HasLeft1) := 0;
  init(WaitRight1) := 0;
  init(HasRight1) := 0;
  init(Fork1) := 1;
  init(IsEating1) := 0;
  init(Idle2) := 1;
  init(WaitLeft2) := 0;
  init(HasLeft2) := 0;
  init(WaitRight2) := 0;
  init(HasRight2) := 0;
  init(Fork2) := 1;
  init(IsEating2) := 0;

DEFINE
  GoEat0_enabled := (Idle0 >= 1);
  GoLeft0_enabled := (WaitLeft0 >= 1) & (Fork2 >= 1);
  GoRight0_enabled := (WaitRight0 >= 1) & (Fork0 >= 1);
  Eat0_enabled := (HasLeft0 >= 1) & (HasRight0 >= 1);
  Release0_enabled := (IsEating0 >= 1);
  GoEat1_enabled := (Idle1 >= 1);
  GoLeft1_enabled := (Fork0 >= 1) & (WaitLeft1 >= 1);
  GoRight1_enabled := (WaitRight1 >= 1) & (Fork1 >= 1);
  Eat1_enabled := (HasLeft1 >= 1) & (HasRight1 >= 1);
  Release1_enabled := (IsEating1 >= 1);
  GoEat2_enabled := (Idle2 >= 1);
  GoLeft2_enabled := (Fork1 >= 1) & (WaitLeft2 >= 1);
  GoRight2_enabled := (WaitRight2 >= 1) & (Fork2 >= 1);
  Eat2_enabled := (HasLeft2 >= 1) & (HasRight2 >= 1);
  Release2_enabled := (IsEating2 >= 1);

  deadlock := !(
    GoEat0_enabled | 
    GoLeft0_enabled | 
    GoRight0_enabled | 
    Eat0_enabled | 
    Release0_enabled | 
    GoEat1_enabled | 
    GoLeft1_enabled | 
    GoRight1_enabled | 
    Eat1_enabled | 
    Release1_enabled | 
    GoEat2_enabled | 
    GoLeft2_enabled | 
    GoRight2_enabled | 
    Eat2_enabled | 
    Release2_enabled
  );

TRANS
  ( GoEat0_enabled &
    ( next(Idle0) =  (Idle0 - 1 ) mod 2 ) &
    ( next(WaitLeft0) =  (WaitLeft0 + 1 ) mod 2 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) =  (WaitRight0 + 1 ) mod 2 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoLeft0_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) =  (WaitLeft0 - 1 ) mod 2 ) &
    ( next(HasLeft0) =  (HasLeft0 + 1 ) mod 2 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) =  (Fork2 - 1 ) mod 2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoRight0_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) =  (WaitRight0 - 1 ) mod 2 ) &
    ( next(HasRight0) =  (HasRight0 + 1 ) mod 2 ) &
    ( next(Fork0) =  (Fork0 - 1 ) mod 2 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    Eat0_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) =  (HasLeft0 - 1 ) mod 2 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) =  (HasRight0 - 1 ) mod 2 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) =  (IsEating0 + 1 ) mod 2 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    Release0_enabled &
    ( next(Idle0) =  (Idle0 + 1 ) mod 2 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) =  (Fork0 + 1 ) mod 2 ) &
    ( next(IsEating0) =  (IsEating0 - 1 ) mod 2 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) =  (Fork2 + 1 ) mod 2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoEat1_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) =  (Idle1 - 1 ) mod 2 ) &
    ( next(WaitLeft1) =  (WaitLeft1 + 1 ) mod 2 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) =  (WaitRight1 + 1 ) mod 2 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoLeft1_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) =  (Fork0 - 1 ) mod 2 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) =  (WaitLeft1 - 1 ) mod 2 ) &
    ( next(HasLeft1) =  (HasLeft1 + 1 ) mod 2 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoRight1_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) =  (WaitRight1 - 1 ) mod 2 ) &
    ( next(HasRight1) =  (HasRight1 + 1 ) mod 2 ) &
    ( next(Fork1) =  (Fork1 - 1 ) mod 2 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    Eat1_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) =  (HasLeft1 - 1 ) mod 2 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) =  (HasRight1 - 1 ) mod 2 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) =  (IsEating1 + 1 ) mod 2 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    Release1_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) =  (Fork0 + 1 ) mod 2 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) =  (Idle1 + 1 ) mod 2 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) =  (Fork1 + 1 ) mod 2 ) &
    ( next(IsEating1) =  (IsEating1 - 1 ) mod 2 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoEat2_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) =  (Idle2 - 1 ) mod 2 ) &
    ( next(WaitLeft2) =  (WaitLeft2 + 1 ) mod 2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) =  (WaitRight2 + 1 ) mod 2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoLeft2_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) =  (Fork1 - 1 ) mod 2 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) =  (WaitLeft2 - 1 ) mod 2 ) &
    ( next(HasLeft2) =  (HasLeft2 + 1 ) mod 2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    GoRight2_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) =  (WaitRight2 - 1 ) mod 2 ) &
    ( next(HasRight2) =  (HasRight2 + 1 ) mod 2 ) &
    ( next(Fork2) =  (Fork2 - 1 ) mod 2 ) &
    ( next(IsEating2) = IsEating2 )
  |
    Eat2_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) =  (HasLeft2 - 1 ) mod 2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) =  (HasRight2 - 1 ) mod 2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) =  (IsEating2 + 1 ) mod 2 )
  |
    Release2_enabled &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) =  (Fork1 + 1 ) mod 2 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) =  (Idle2 + 1 ) mod 2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) =  (Fork2 + 1 ) mod 2 ) &
    ( next(IsEating2) =  (IsEating2 - 1 ) mod 2 )
  |
    deadlock &
    ( next(Idle0) = Idle0 ) &
    ( next(WaitLeft0) = WaitLeft0 ) &
    ( next(HasLeft0) = HasLeft0 ) &
    ( next(WaitRight0) = WaitRight0 ) &
    ( next(HasRight0) = HasRight0 ) &
    ( next(Fork0) = Fork0 ) &
    ( next(IsEating0) = IsEating0 ) &
    ( next(Idle1) = Idle1 ) &
    ( next(WaitLeft1) = WaitLeft1 ) &
    ( next(HasLeft1) = HasLeft1 ) &
    ( next(WaitRight1) = WaitRight1 ) &
    ( next(HasRight1) = HasRight1 ) &
    ( next(Fork1) = Fork1 ) &
    ( next(IsEating1) = IsEating1 ) &
    ( next(Idle2) = Idle2 ) &
    ( next(WaitLeft2) = WaitLeft2 ) &
    ( next(HasLeft2) = HasLeft2 ) &
    ( next(WaitRight2) = WaitRight2 ) &
    ( next(HasRight2) = HasRight2 ) &
    ( next(Fork2) = Fork2 ) &
    ( next(IsEating2) = IsEating2 )
  );
